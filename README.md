## CRITIC_cross-efficiency_DEA Application to the three-level hierarchical DEA model in Kao (2015)
Kao (2015) [^1] evaluated the physic department of twenty universities by the hierarchical data envelopment analysis(DEA) model. Based on the network DEA, the department system is 
decomposed into four subordiantes 
1. $E^{U}$ (teaching of undergarduates)
2. $E^{G}$ (teaching of graduates)
3. $E^{R}$ (research)  
4. $E^{S}$ (services)

Below is a diagram depicting a hierarchical network structure with **2** inputs and 
**7** outputs.
<img width="451" alt="Screenshot 2023-01-07 at 17 46 17" src="https://user-images.githubusercontent.com/76271974/211163720-4a1e64ba-1bba-45fd-ad84-f82cbba54af1.png">

Taking the resource-allocation problem between the undergraduate and graduate sections,
Kao (2015) defined the following shared-inputs hierarhical network DEA model after 
decomposititon.

<img width="392" alt="Screenshot 2023-01-07 at 17 58 34" src="https://user-images.githubusercontent.com/76271974/211164198-4e633dbe-6b81-4370-8470-705bf5881f60.png">

Note that $\alpha_{1},\alpha_{2},\alpha_{3}$ represent the allocating proportion of inputs 
to teaching (Unit 1), research (Unit2) and service (Unit3), while $\beta_{1}, \beta_{2}$ 
indicate the allocation proportion for undergraduate (Unit 1-1)and graduate divisions 
(Unit 1-2). 

In above model, the first five constraints control the efficiency range of the overall 
inputs and four units - _the efficiency of each unit should be no greater than 1_. And the fifth constraint defines the range of  allocation indexes $\alpha_{1},\alpha_{2},\alpha_{3}$ , $\beta_{1}, \beta_{2}$.Then, let's see the model result by Kao (2015).

<img width="558" alt="Screenshot 2023-01-07 at 17 41 55" src="https://user-images.githubusercontent.com/76271974/211163543-fc0d7cfb-2757-4721-98b4-f33599b15d48.png">

The second column in the table above is the network DEA result by CCR model, in which over
half of DMUs are evaluated as efficient. Compared with CCR model result, the result in
the third column shows better discrimintory power.

However, there are three issues exist:
1. lacking of peer-evaluated result, making the result less acceptable by DMUs.
2. Not all DMUs receive a unique ranking in $E^{U}$, $E^{G}$. $E^{R}$, $E^{S}$.
3. Many zeroes in multipliers generated by this model. 

## Proposed CRITIC cross-efficiency approach
Here compares Kao's model with two models:
1. Liu et al. (2022)'s [^2] combination of **maxmin secondary objective model** and **neutral cross-efficiency model**.
2. A combination of **maxmin secondary objective model** and **CRITIC cross-efficiency model**.

#### Maxmin DEA model
Both methods utlize the maxmin secondary objective DEA model before applying the cross-efficiency approach, which is
very powerful in solving the zero values in multipliers. 
The coding has been prepared which can be run on Lingo software. It demadns **20 times** running of [self-evaluated 
three-level hierarchical DEA model](./SelfEvaHierarchialDEA.lng) proposed by Kao (2015).\
_Note: We can get each DMU's self-evaluated efficiency of each component by adjusting the k value on the 30th line._

After recording the $E^{U}$, $E^{G}$. $E^{R}$, $E^{S}$, $E^{NW}$ results for each DMU, making them as inputs, along 
with k in [maxmin secondary objective model](./Maxmin_DEA_model.lng) to get the maxmin DEA results with another 
**20 times** running of the program.

After these two steps, we can get five efficiency matrixs, in which $E_{kj}$ indicates the jth observation under
kth criteria, see [CE DEA.xlsx - sheet1- summary](./CE_DEA.xlsx)

#### Liu et al's Neutral CE approach.
In Liu et al's CE approach, they didn't directly use the peer-evaluated netwrok efficiency as the overall performance.
They calcualted the network efficiency as the weighted average of four components' efficiencies. Let's see:

Under each component matrix:
1. They calculated the arithmetic average of a DMU's column. 
2. Using each DMU's inputs to total inputs as its contribution to the network efficiency, so this method also called a input-oriented way.
3. Calculating the network efficiency for DMU.
The process of calculating the network efficiency has been shown in below table:

<img width="666" alt="Screenshot 2023-01-08 at 01 06 45" src="https://user-images.githubusercontent.com/76271974/211176166-96b72936-5fdb-4a1d-a7b8-0a5f6dc6840c.png">

#### CRITIC CE approach
The CRITIC CE considers the information value in efficiency table, and considers separately, but based on the standarded
error and correlation rate of peer opinions. Here gives the example of $E_{k}^{U}$:
<img width="689" alt="Screenshot 2023-01-08 at 01 11 46" src="https://user-images.githubusercontent.com/76271974/211176285-478bc62e-8a4e-4b2d-8348-6f0ff34e192f.png">
_Note: the rows of table indicate the criteria of a DMU while the column indicates an observation_

1. Calculate the standard error(SE) of each criteria (each row). On the sd column, the first number represents the SE of the first criteria given by the maxmin result of DMU1. 

<img width="278" alt="Screenshot 2023-01-08 at 01 14 04" src="https://user-images.githubusercontent.com/76271974/211176330-f8aa9f3b-43bf-4fd9-b3ec-8f7ab39db3e9.png">

2. Calculate the Spearman matrix for this undergraduate component efficiency matrix, given the result $R_{kj}$

3. Calculate 1 - $R_{kj}$

<img width="730" alt="Screenshot 2023-01-08 at 01 17 20" src="https://user-images.githubusercontent.com/76271974/211176398-21b4834d-f00d-4931-9982-4bc00c4d15e4.png">

4. Calculate the conflict for each criteria  = SE * (1 - $R_{kj}$ )

5. Calculate the weight of each criteria as it's divided by the total value of conflicts

6. Calculate the final $E^{U}_{j}$ for each DMU.

<img width="242" alt="Screenshot 2023-01-08 at 01 21 09" src="https://user-images.githubusercontent.com/76271974/211176489-d6e6e77f-bf1a-45d0-accf-7b1c16343b76.png">

Therefore, under the CRITIC CE approach, we are not required to consider how each suboridnates contributing to the
final network efficiency. Then below gives the measurement comparsion between Kao's model and previously discussed 
two CE approaches.




**Network Efficiency**

<img width="626" alt="Screenshot 2023-01-08 at 01 24 43" src="https://user-images.githubusercontent.com/76271974/211176609-1dad9daf-a9c0-451c-921b-58f06b094ebd.png">

**Components Efficiency**

<img width="505" alt="Screenshot 2023-01-08 at 01 25 28" src="https://user-images.githubusercontent.com/76271974/211176622-7195a026-abb8-4d76-a517-7370a87fa43b.png">

#### Additioanl part
If you are interested, you can compare the result by two entropy methods - Shannon entropy and CRITIC entropy,
here has contributed the Python script that can automatically calculate the entropy results. [click here](./entropy.py)

[^1]: Kao, C. (2015). Efficiency measurement for hierarchical network systems. Omega, 51, pp.121â€“127. doi:10.1016/j.omega.2014.09.008.
[^2]: Liu, P., Zhang, Y. and Xu, H. (2022). A neutral cross-efficiency measurement for general parallel production system. Expert Systems with Applications, 205, p.117778. doi:10.1016/j.eswa.2022.117778.

